

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-164358105-1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'UA-164358105-1');
    </script>
    
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Analyzing Passive Acoustic Data with MHKiT &mdash; MHKiT v0.9.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=5b801204" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=5ea31d45" />
      <link rel="stylesheet" type="text/css" href="_static/nbsphinx-code-cells.css?v=2aa19091" />
      <link rel="stylesheet" type="text/css" href="_static/css/mhkit.css?v=20290a2c" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=c20ff342"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Analyzing ADCP Data with MHKiT" href="adcp_example.html" />
    <link rel="prev" title="MHKiT WPTO Hindcast Example" href="WPTO_hindcast_example.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            MHKiT
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">MHKiT-Python Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="matlab_installation.html">MHKiT-MATLAB Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="module.html">Module Overview</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="examples.html">Examples</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="examples.html#overview">Overview</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="examples.html#all-python-notebooks">All Python Notebooks</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="ADCP_Delft3D_TRTS_example.html">Comparing Transect Data at the Tanana River Test Site</a></li>
<li class="toctree-l3"><a class="reference internal" href="Delft3D_example.html">Delft3D IO Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="PacWave_resource_characterization_example.html">PacWave Resource Assessment</a></li>
<li class="toctree-l3"><a class="reference internal" href="SWAN_example.html">MHKiT SWAN Example</a></li>
<li class="toctree-l3"><a class="reference internal" href="WPTO_hindcast_example.html">MHKiT WPTO Hindcast Example</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Analyzing Passive Acoustic Data with MHKiT</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Read-in-Hydrophone-Measurements">Read in Hydrophone Measurements</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Mean-Square-Sound-Pressure-Spectral-Density">Mean Square Sound Pressure Spectral Density</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Applying-Calibration-Curves">Applying Calibration Curves</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Mean-Square-Sound-Pressure-Spectral-Density-Level">Mean Square Sound Pressure Spectral Density Level</a></li>
<li class="toctree-l4"><a class="reference internal" href="#IEC-40-Stats">IEC-40 Stats</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Window-Aggregating">Window Aggregating</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Band-Averaging">Band Averaging</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Sound-Pressure-Level">Sound Pressure Level</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Decidecade-Sound-Pressure-Levels">Decidecade Sound Pressure Levels</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Third-Octave-Sound-Pressure-Level">Third Octave Sound Pressure Level</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="adcp_example.html">Analyzing ADCP Data with MHKiT</a></li>
<li class="toctree-l3"><a class="reference internal" href="adv_example.html">Reading ADV Data with MHKiT</a></li>
<li class="toctree-l3"><a class="reference internal" href="cdip_example.html">MHKiT CDIP IO</a></li>
<li class="toctree-l3"><a class="reference internal" href="environmental_contours_example.html">MHKiT Environmental Contours</a></li>
<li class="toctree-l3"><a class="reference internal" href="extreme_response_MLER_example.html">MLER example</a></li>
<li class="toctree-l3"><a class="reference internal" href="extreme_response_contour_example.html">Extreme Conditions Modeling - Contour Approach</a></li>
<li class="toctree-l3"><a class="reference internal" href="extreme_response_full_sea_state_example.html">Extreme Conditions Modeling - Full Sea State Approach</a></li>
<li class="toctree-l3"><a class="reference internal" href="loads_example.html">MHKiT Loads Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="metocean_example.html">MHKiT Metocean Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="mooring_example.html">Mooring Module Example</a></li>
<li class="toctree-l3"><a class="reference internal" href="power_example.html">MHKiT Power Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="qc_example.html">MHKiT Quality Control Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="river_example.html">MHKiT River Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="short_term_extremes_example.html">MHKit Short-term Extreme Loads</a></li>
<li class="toctree-l3"><a class="reference internal" href="strain_measurement_example.html">Strain Measurement Example</a></li>
<li class="toctree-l3"><a class="reference internal" href="tidal_example.html">MHKiT Tidal Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="tidal_performance_example.html">Tidal Power Performance Analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="upcrossing_example.html">MHKit Upcrossing Analysis Example</a></li>
<li class="toctree-l3"><a class="reference internal" href="wave_example.html">MHKiT Wave Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="wecsim_example.html">MHKiT WEC-Sim Example</a></li>
<li class="toctree-l3"><a class="reference internal" href="directional_waves.html">Directional Wave Spectrum from NDBC Buoys</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="troubleshooting.html">Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="terminology.html">Terminology</a></li>
<li class="toctree-l1"><a class="reference internal" href="webinars.html">Webinars</a></li>
<li class="toctree-l1"><a class="reference internal" href="license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="release_notes.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="citeus.html">Cite Us</a></li>
<li class="toctree-l1"><a class="reference internal" href="contact.html">Online Forum</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">MHKiT</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="examples.html">Examples</a></li>
      <li class="breadcrumb-item active">Analyzing Passive Acoustic Data with MHKiT</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/acoustics_example.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="Analyzing-Passive-Acoustic-Data-with-MHKiT">
<h1>Analyzing Passive Acoustic Data with MHKiT<a class="headerlink" href="#Analyzing-Passive-Acoustic-Data-with-MHKiT" title="Link to this heading"></a></h1>
<p>The following example illustrates how to read and analyze some basic parameters for passive acoustics data. Functionality to analyze .wav files recorded using hydrophones has been integrated into MHKiT to support analysis based on the IEC-TS 62600-40 standard.</p>
<p>The standard workflow for passive acoustics analysis is as follows:</p>
<ol class="arabic simple">
<li><p>Import .wav file</p></li>
<li><p>Calibrate data</p></li>
<li><p>Calculate spectral density</p></li>
<li><p>Calculate other parameters</p></li>
<li><p>Create plots</p></li>
</ol>
<p>We’ll import a couple plotting tools and the acoustics module:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.dates</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">mdates</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">mhkit</span><span class="w"> </span><span class="kn">import</span> <span class="n">acoustics</span>
</pre></div>
</div>
</div>
<section id="Read-in-Hydrophone-Measurements">
<h2>Read in Hydrophone Measurements<a class="headerlink" href="#Read-in-Hydrophone-Measurements" title="Link to this heading"></a></h2>
<p>All hydrophone .wav files can be read in MHKiT using a base function called <code class="docutils literal notranslate"><span class="pre">read_hydrophone</span></code> from the acoustics.io submodule. Because the sampling frequency is so fast, measurements are stored in the lowest memory format possible and need to be scaled and transformed to return the measurements in units of voltage or pressure.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">read_hydrophone</span></code> function scales and transforms raw measurements given a few input parameters. Most parameters needed to convert the raw data are stored in the native .wav format header blocks, but two, the peak voltage (“peak_voltage”) of the sensor’s analog-to-digital converter (ADC) and file “start_time” (usually stored in the filename) are required.</p>
<p>Two other inputs, the hydrophone sensitivity (“sensitivity”) and an amplifier gain (“gain”) can also be input. If a sensitivity value is provided, the function will convert voltage to pressure; otherwise the sensitivity(ies) can be provided later using a calibration curve. Gain should be provided if the instrument utilizes an amplifier gain (typically for custom hydrophone builds), which is then added to the sensitivity.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">P</span> <span class="o">=</span> <span class="n">acoustics</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">read_hydrophone</span><span class="p">(</span>
    <span class="s2">&quot;data/acoustics/RBW_6661_20240601_053114.wav&quot;</span><span class="p">,</span>
    <span class="n">peak_voltage</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
    <span class="n">sensitivity</span><span class="o">=-</span><span class="mi">177</span><span class="p">,</span>
    <span class="n">gain</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">start_time</span><span class="o">=</span><span class="s2">&quot;2024-06-01T05:31:14&quot;</span>
<span class="p">)</span>
<span class="c1"># `P` is returned as an xarray DataArray, which allows easy handling of labeled multi-dimensional arrays.</span>
<span class="c1"># In this case, the array represents sound pressure in Pascals (Pa) over time because the calibrated sensitivity was passed.</span>
<span class="nb">print</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;xarray.DataArray (time: 30720000)&gt; Size: 246MB
array([0.31546374, 0.30229832, 0.32229963, ..., 0.08506887, 0.07291618,
       0.06278893])
Coordinates:
  * time     (time) datetime64[ns] 246MB 2024-06-01T05:31:14 ... 2024-06-01T0...
Attributes:
    units:        Pa
    sensitivity:  1.413e-09
    resolution:   9.89e-07
    valid_min:    -2123.837353
    valid_max:    2123.837353
    fs:           512000
    filename:     RBW_6661_20240601_053114
</pre></div></div>
</div>
<p>“Smart” hydrophones are those where the hydrophone element, pre-amplifier board, ADC, motherboard and memory card are sold in a single package. Companies that sell these often store metadata in the .wav file header, and MHKiT has a couple of wrapper functions for these hydrophones.</p>
<p>OceanSonics icListen and OceanInstruments Soundtrap are two common smart hydrophone models, with examples as follows.</p>
<p>For icListen datafiles, only the filename is necessary to provide to return file contents in units of pressure. The stored sensitivity calibration value can be overridden by setting the “sensitivity” input, and to return measurements in units of voltage, set <code class="docutils literal notranslate"><span class="pre">sensitivity</span></code> to None and <code class="docutils literal notranslate"><span class="pre">use_metadata</span></code> to False.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">P</span> <span class="o">=</span> <span class="n">acoustics</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">read_iclisten</span><span class="p">(</span><span class="s2">&quot;data/acoustics/RBW_6661_20240601_053114.wav&quot;</span><span class="p">)</span>
<span class="n">V</span> <span class="o">=</span> <span class="n">acoustics</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">read_iclisten</span><span class="p">(</span>
    <span class="s2">&quot;data/acoustics/RBW_6661_20240601_053114.wav&quot;</span><span class="p">,</span>
    <span class="n">sensitivity</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">use_metadata</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<p>For Ocean Instruments Soundtrap datafiles, the filename and sensitivity should be provided to return the measurements in units of pressure. If the hydrophone has been calibrated, set the sensitivity to None to return the measurements in units of voltage.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">P</span> <span class="o">=</span> <span class="n">acoustics</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">read_soundtrap</span><span class="p">(</span><span class="s2">&quot;data/acoustics/6247.230204150508.wav&quot;</span><span class="p">,</span> <span class="n">sensitivity</span><span class="o">=-</span><span class="mi">177</span><span class="p">)</span>
<span class="n">V</span> <span class="o">=</span> <span class="n">acoustics</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">read_soundtrap</span><span class="p">(</span><span class="s2">&quot;data/acoustics/6247.230204150508.wav&quot;</span><span class="p">,</span> <span class="n">sensitivity</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Mean-Square-Sound-Pressure-Spectral-Density">
<h2>Mean Square Sound Pressure Spectral Density<a class="headerlink" href="#Mean-Square-Sound-Pressure-Spectral-Density" title="Link to this heading"></a></h2>
<p>After the .wav file is read in, either in units of pressure or voltage, we calculate the mean square sound pressure spectral density (SPSD) of the timeseries using <code class="docutils literal notranslate"><span class="pre">sound_pressure_spectral_density</span></code>. This splits the timeseries into windows and uses fast Fourier transforms to convert the raw measurements into the frequency domain, with units of <span class="math notranslate nohighlight">\(Pa^2/Hz\)</span> or <span class="math notranslate nohighlight">\(V^2/Hz\)</span>, depending on the input. The function takes the original datafile, the hydrophone’s sampling rate (“fs”), which is
stored as an attribute of the measurement timeseries, and a window size (“bin_length”) in seconds as input.</p>
<p>The IEC-40 considers an acoustic sample to have a length of 1 second, so we’ll set the bin length as such here.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create mean square spectral densities using 1 s bins.</span>
<span class="n">spsd</span> <span class="o">=</span> <span class="n">acoustics</span><span class="o">.</span><span class="n">sound_pressure_spectral_density</span><span class="p">(</span><span class="n">V</span><span class="p">,</span> <span class="n">V</span><span class="o">.</span><span class="n">fs</span><span class="p">,</span> <span class="n">bin_length</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Applying-Calibration-Curves">
<h2>Applying Calibration Curves<a class="headerlink" href="#Applying-Calibration-Curves" title="Link to this heading"></a></h2>
<p>For conducting scientific-grade analysis, it is critical to use calibration curves to correct the SPSD calculations. Hydrophones should be calibrated (i.e., a sensitivity calibration curve should be generated for a hydrophone) every few years. The IEC-40 asks that a hydrophone be calibrated both before and after the test deployment.</p>
<p>A calibration curve consists of the hydrophone’s sensitivity (in units of <span class="math notranslate nohighlight">\(dB\)</span> rel <span class="math notranslate nohighlight">\(1\)</span> <span class="math notranslate nohighlight">\(V^2/uPa^2\)</span>) vs frequency and should be applied to the spectral density we just calculated.</p>
<p>The easiest way to apply a sensitivity calibration curve in MHKiT is to first copy the calibration data into a CSV file, where the left column contains the calibrated frequencies and the right column contains the sensitivity values. Here we use the function in the following codeblock to read in a CSV file created with the column headers “Frequency” and “Analog Sensitivity”.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="k">def</span><span class="w"> </span><span class="nf">read_calibration_file</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
    <span class="n">calibration</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
    <span class="n">calibration</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">calibration</span><span class="p">[</span><span class="s2">&quot;Frequency&quot;</span><span class="p">]</span>
    <span class="n">calibration</span> <span class="o">=</span> <span class="n">calibration</span><span class="o">.</span><span class="n">to_xarray</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">calibration</span><span class="p">[</span><span class="s2">&quot;Analog Sensitivity&quot;</span><span class="p">]</span>

<span class="n">sensitivity_curve</span> <span class="o">=</span> <span class="n">read_calibration_file</span><span class="p">(</span><span class="s2">&quot;data/acoustics/6247_calibration.csv&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sensitivity_curve</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;xarray.DataArray &#39;Analog Sensitivity&#39; (Frequency: 40)&gt; Size: 320B
array([-223.49, -220.8 , -218.13, -215.41, -212.68, -209.91, -207.12,
       -204.29, -201.45, -198.58, -195.69, -192.79, -189.85, -186.9 ,
       -183.93, -180.93, -177.92, -174.97, -172.16, -169.61, -167.69,
       -166.52, -165.96, -165.81, -165.85, -165.95, -166.05, -166.13,
       -166.2 , -166.25, -166.28, -166.29, -166.29, -166.27, -166.24,
       -166.17, -166.03, -165.79, -165.47, -164.87])
Coordinates:
  * Frequency  (Frequency) float64 320B 1.0 1.183 1.399 ... 500.3 591.8 700.0
</pre></div></div>
</div>
<p>Once we have the calibration data in an xarray DataArray, we can apply that to the SPSD using the <code class="docutils literal notranslate"><span class="pre">apply_calibration</span></code> function. Calibration curves typically do not cover the entire range of the hydrophone, so this function will linearly interpolate the missing values. A fill_value can be provided to extrapolate outside of the calibrated frequencies.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Use last value in calibration curve for higher frequencies</span>
<span class="n">fill_Sf</span> <span class="o">=</span> <span class="n">sensitivity_curve</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">spsd</span> <span class="o">=</span> <span class="n">acoustics</span><span class="o">.</span><span class="n">apply_calibration</span><span class="p">(</span><span class="n">spsd</span><span class="p">,</span> <span class="n">sensitivity_curve</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="n">fill_Sf</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Mean-Square-Sound-Pressure-Spectral-Density-Level">
<h2>Mean Square Sound Pressure Spectral Density Level<a class="headerlink" href="#Mean-Square-Sound-Pressure-Spectral-Density-Level" title="Link to this heading"></a></h2>
<p>We can use the function <code class="docutils literal notranslate"><span class="pre">sound_pressure_spectral_density_level</span></code> to calculate the mean square sound pressure spectral density levels (SPSDLs) from the calibrated SPSD. This function converts absolute pressure into relative pressure in log-space, the traditional means with which we measure sound, in units of decibels relative to 1 uPa (<span class="math notranslate nohighlight">\(dB\)</span> rel <span class="math notranslate nohighlight">\(1\)</span> <span class="math notranslate nohighlight">\(uPa\)</span>), the standard for underwater sound.</p>
<p>Sidenote: Sound in air is measured in decibels relative to 20 uPa, the minimum sound pressure humans can hear. To convert between “<span class="math notranslate nohighlight">\(dB\)</span> rel <span class="math notranslate nohighlight">\(1\)</span> <span class="math notranslate nohighlight">\(uPa\)</span>” and “<span class="math notranslate nohighlight">\(dB\)</span> rel <span class="math notranslate nohighlight">\(20\)</span> <span class="math notranslate nohighlight">\(uPa\)</span>”, one simply needs to subtract 26 dB from the “<span class="math notranslate nohighlight">\(dB\)</span> rel <span class="math notranslate nohighlight">\(1\)</span> <span class="math notranslate nohighlight">\(uPa\)</span>” value.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">spsdl</span> <span class="o">=</span> <span class="n">acoustics</span><span class="o">.</span><span class="n">sound_pressure_spectral_density_level</span><span class="p">(</span><span class="n">spsd</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Now that the SPSDL is calculated, we can create spectrograms, or waterfall plots, using the <code class="docutils literal notranslate"><span class="pre">plot_spectrogram</span></code> function in the graphics submodule. While spectrograms aren’t required by the IEC-40, they are useful to do quality control so we can avoid using contaminated soundbytes in further analysis (like the boat noise shown in this one).</p>
<p>To do this, we’ll give the function the minimum and maximum frequencies to plot, as well as keyword arguments supplied to the matplotlib <code class="docutils literal notranslate"><span class="pre">pcolormesh</span></code> function. For these measurements, we’re setting fmin = 10 Hz, the minimum specified by the IEC-40, and fmax = 48,000 Hz, the Nyquist frequency for these data.</p>
<p>Note, the IEC-40 requires a maximum frequency of 100,000 Hz, so a hydrophone capable of sampling faster than 200,000 Hz should be used for IEC testing.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Show Nyquist frequency (maximum in frequency vector)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">spsdl</span><span class="p">[</span><span class="s2">&quot;freq&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;xarray.DataArray &#39;freq&#39; ()&gt; Size: 8B
array(48000.)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fmin</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">fmax</span> <span class="o">=</span> <span class="mi">48000</span>

<span class="c1"># Create high resolution spectrogram</span>
<span class="n">kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;cmap&quot;</span><span class="p">:</span> <span class="s2">&quot;inferno&quot;</span><span class="p">,</span> <span class="s2">&quot;vmin&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;vmax&quot;</span><span class="p">:</span> <span class="mi">100</span><span class="p">}</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">acoustics</span><span class="o">.</span><span class="n">graphics</span><span class="o">.</span><span class="n">plot_spectrogram</span><span class="p">(</span>
    <span class="n">spsdl</span><span class="p">,</span> <span class="n">fmin</span><span class="p">,</span> <span class="n">fmax</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">mdates</span><span class="o">.</span><span class="n">DateFormatter</span><span class="p">(</span><span class="s2">&quot;%H:%M:%S&quot;</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">mdates</span><span class="o">.</span><span class="n">MinuteLocator</span><span class="p">(</span><span class="n">interval</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">mdates</span><span class="o">.</span><span class="n">MinuteLocator</span><span class="p">())</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/acoustics_example_18_0.png" src="_images/acoustics_example_18_0.png" />
</div>
</div>
<p>If you see something interesting in the spectrogram, the next step you should do is listen to the .wav file. This can tell you a lot about what you’re looking at. If you listen to this file, you’ll hear the boat cruising by around 3 minutes in.</p>
<p>Some audio players aren’t able to play some hydrophone recodings (i.e. icListens), so be sure to try multiple if you can’t hear anything in one particular player. Higher-end hydrophones tend to user higher ADC peak voltages, which will translate to quieter audio tracks. You can use the <code class="docutils literal notranslate"><span class="pre">export_audio</span></code> file in the io submodule to rescale these audio tracks and increase the gain if need be.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Uncomment to save new file</span>
<span class="n">filename</span> <span class="o">=</span> <span class="s2">&quot;sound1.wav&quot;</span>
<span class="c1">#acoustics.io.export_audio(filename, P, gain=1)</span>
</pre></div>
</div>
</div>
</section>
<section id="IEC-40-Stats">
<h2>IEC-40 Stats<a class="headerlink" href="#IEC-40-Stats" title="Link to this heading"></a></h2>
<p>The IEC-40 requires a few aggregate statistics for characterizing the sound of marine energy devices. For the first, the IEC-40 asks for plots showing the 25%, 50%, and 75% quantiles of the SPSDL during specific marine energy device states. For current energy devices, the IEC-40 requires 10 SPSDL samples at a series of turbine states (braked, freewheel, 25% power, 50% power, 75% power, 100% power). For wave energy devices, the spec requires 30 SPSDL samples in each wave height and period bin
observed.</p>
<p>For this example notebook we’ll keep it simple and use a random set of 30 samples and collate them together. Otherwise one can pick and choose which to use. Then we can find the median and quantiles of those 30 samples.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">random</span>
<span class="n">samples</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">spsdl</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">size</span><span class="p">),</span> <span class="mi">30</span><span class="p">)</span>
<span class="n">spsdl_clip</span> <span class="o">=</span> <span class="n">spsdl</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">samples</span><span class="p">)</span>

<span class="n">spsdl_median</span> <span class="o">=</span> <span class="n">spsdl_clip</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span>
<span class="n">spsdl_q25</span> <span class="o">=</span> <span class="n">spsdl_clip</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.25</span><span class="p">,</span> <span class="s2">&quot;time&quot;</span><span class="p">)</span>
<span class="n">spsdl_q75</span> <span class="o">=</span> <span class="n">spsdl_clip</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.75</span><span class="p">,</span> <span class="s2">&quot;time&quot;</span><span class="p">)</span>

<span class="c1"># Plot medians and quantiles</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">acoustics</span><span class="o">.</span><span class="n">graphics</span><span class="o">.</span><span class="n">plot_spectra</span><span class="p">(</span><span class="n">spsdl_median</span><span class="p">,</span> <span class="n">fmin</span><span class="p">,</span> <span class="n">fmax</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span>
    <span class="n">spsdl_clip</span><span class="p">[</span><span class="s2">&quot;freq&quot;</span><span class="p">],</span>
    <span class="n">spsdl_q25</span><span class="p">,</span>
    <span class="n">spsdl_q75</span><span class="p">,</span>
    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
    <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;C0&quot;</span><span class="p">,</span>
    <span class="n">edgecolor</span><span class="o">=</span><span class="kc">None</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;dB rel 1 uPa^2/Hz^2&quot;</span><span class="p">,</span> <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">80</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Median and Quantile Sound Pressure Spectral Density Level&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0.5, 1.0, &#39;Median and Quantile Sound Pressure Spectral Density Level&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/acoustics_example_22_1.png" src="_images/acoustics_example_22_1.png" />
</div>
</div>
</section>
<section id="Window-Aggregating">
<h2>Window Aggregating<a class="headerlink" href="#Window-Aggregating" title="Link to this heading"></a></h2>
<p>If desired, one can also group a series of measurements into blocks of time. In the following block, we’ll take our 5 minutes of measurements, <code class="docutils literal notranslate"><span class="pre">time_aggregate</span></code> them into 30 second intervals, and find the median, 25% and 75% quantiles of each interval. We then plot the stats of the first time block (block #0).</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Time average into 30 s windows</span>
<span class="n">window</span> <span class="o">=</span> <span class="mi">30</span>
<span class="n">spsdl_50</span> <span class="o">=</span> <span class="n">acoustics</span><span class="o">.</span><span class="n">time_aggregate</span><span class="p">(</span><span class="n">spsdl</span><span class="p">,</span> <span class="n">window</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;median&quot;</span><span class="p">)</span>
<span class="n">spsdl_25</span> <span class="o">=</span> <span class="n">acoustics</span><span class="o">.</span><span class="n">time_aggregate</span><span class="p">(</span><span class="n">spsdl</span><span class="p">,</span> <span class="n">window</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;quantile&quot;</span><span class="p">:</span><span class="mf">0.25</span><span class="p">})</span>
<span class="n">spsdl_75</span> <span class="o">=</span> <span class="n">acoustics</span><span class="o">.</span><span class="n">time_aggregate</span><span class="p">(</span><span class="n">spsdl</span><span class="p">,</span> <span class="n">window</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;quantile&quot;</span><span class="p">:</span><span class="mf">0.75</span><span class="p">})</span>
</pre></div>
</div>
</div>
<p>We can then using the <code class="docutils literal notranslate"><span class="pre">plot_spectra</span></code> function in the graphics submodule to plot the median and quantiles of the first 30 s window.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot medians and quantiles</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">acoustics</span><span class="o">.</span><span class="n">graphics</span><span class="o">.</span><span class="n">plot_spectra</span><span class="p">(</span><span class="n">spsdl_50</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">fmin</span><span class="p">,</span> <span class="n">fmax</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span>
    <span class="n">spsdl_50</span><span class="p">[</span><span class="s2">&quot;freq&quot;</span><span class="p">],</span>
    <span class="n">spsdl_25</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
    <span class="n">spsdl_75</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
    <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;C0&quot;</span><span class="p">,</span>
    <span class="n">edgecolor</span><span class="o">=</span><span class="kc">None</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">80</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Median and Quantile Sound Pressure Spectral Density Level&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0.5, 1.0, &#39;Median and Quantile Sound Pressure Spectral Density Level&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/acoustics_example_26_1.png" src="_images/acoustics_example_26_1.png" />
</div>
</div>
</section>
<section id="Band-Averaging">
<h2>Band Averaging<a class="headerlink" href="#Band-Averaging" title="Link to this heading"></a></h2>
<p>Analysis can also be completed by grouping the data into specific frequency bands, called “band aggregating” here. In other words, instead of aggregating by the time dimension, we aggregate by the frequency dimension. The <code class="docutils literal notranslate"><span class="pre">band_aggregate</span></code> function operates by taking the SPSDL and grouping it based on a specified octave.</p>
<p>If one wants to do more analysis on the grouped frequency bands than the simple statistical methods that xarray offers, it is possible to use the “map” function to apply a custom function to a file. In the following block of code, we find the empirical quantile function (the empirical version of the cumulative distribution function, CDF) to each decidecade (10th octave) frequency band and plot the 160 Hz band.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">quantile_function</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="c1"># Empirical CDF/Quantile Function/Exceedance Probability</span>
    <span class="c1"># Use the median of the coordinate we&#39;re grouped in</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="s2">&quot;freq&quot;</span><span class="p">)</span>
    <span class="c1"># Squeeze to remove frequency dimension</span>
    <span class="n">shape</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x_sorted</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
    <span class="c1"># calculate the proportional values of samples</span>
    <span class="n">p</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="c1"># recreate dataarray</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">assign_coords</span><span class="p">({</span><span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="n">p</span><span class="p">})</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="s2">&quot;probability&quot;</span><span class="p">})</span>
    <span class="n">x</span><span class="o">.</span><span class="n">values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">x_sorted</span><span class="p">,</span> <span class="n">shape</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">x</span>


<span class="n">cdfs</span> <span class="o">=</span> <span class="n">acoustics</span><span class="o">.</span><span class="n">band_aggregate</span><span class="p">(</span><span class="n">spsdl</span><span class="p">,</span> <span class="n">octave</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;map&quot;</span><span class="p">:</span> <span class="n">quantile_function</span><span class="p">})</span>
<span class="c1"># Plot</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cdfs</span><span class="p">[</span><span class="mi">40</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">cdfs</span><span class="p">[</span><span class="s2">&quot;probability&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span>
    <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">cdfs</span><span class="p">[</span><span class="s1">&#39;freq_bins&#39;</span><span class="p">][</span><span class="mi">40</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2"> Hz&quot;</span><span class="p">,</span>
    <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;Exceedance Probability&quot;</span><span class="p">,</span>
    <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;Decidecade SPSDL [dB re 1 uPa^2/Hz]&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
c:\users\mcve343\mhkit-python\mhkit\acoustics\analysis.py:83: UserWarning: `fmax` = 100000 is greater than the Nyquist frequency. Settingfmax = 48000.0
  warnings.warn(
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[Text(0.5, 1.0, &#39;160.0 Hz&#39;),
 Text(0, 0.5, &#39;Exceedance Probability&#39;),
 Text(0.5, 0, &#39;Decidecade SPSDL [dB re 1 uPa^2/Hz]&#39;)]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/acoustics_example_28_2.png" src="_images/acoustics_example_28_2.png" />
</div>
</div>
<p>Another plot that is useful for IEC-40 compliance are decidecade boxplots of the SPSDL. We can also use the aggregate methods to apply plotting functions, like matplotlib’s native boxplot. In this case, we supply the “map” function and an iterable of the custom function inputs, in this case the figure axes we want to use to plot.</p>
<p>This plot shows significant spread in sound measurements due to the vessel noise, with whiskers stretching to the 1st and 99th quantiles. Generally any significant spread in a frequency band is caused by sound generated by an external source, and not the ambient soundscape.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">boxplot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">ax</span><span class="p">):</span>
    <span class="c1"># Use the median of the coordinate we&#39;re grouped in</span>
    <span class="n">freq</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="s2">&quot;freq&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;freq&quot;</span><span class="p">)</span>
    <span class="c1"># Create boxplots</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span>
        <span class="n">x</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
        <span class="n">whis</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">99</span><span class="p">),</span>
        <span class="n">showfliers</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">positions</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">freq</span><span class="o">.</span><span class="n">values</span><span class="p">)],</span>
        <span class="n">widths</span><span class="o">=</span><span class="mf">0.015</span><span class="p">,</span>
        <span class="n">flierprops</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;marker&quot;</span><span class="p">:</span> <span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="s2">&quot;markersize&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">x</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">acoustics</span><span class="o">.</span><span class="n">band_aggregate</span><span class="p">(</span>
    <span class="n">spsdl</span><span class="p">,</span> <span class="n">octave</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;map&quot;</span><span class="p">:</span> <span class="p">(</span><span class="n">boxplot</span><span class="p">,</span> <span class="p">[</span><span class="n">ax</span><span class="p">])}</span>
<span class="p">)</span>
<span class="n">xticks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span>
    <span class="n">xticks</span><span class="o">=</span><span class="n">xticks</span><span class="p">,</span>
    <span class="n">xticklabels</span><span class="o">=</span><span class="n">xticks</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">),</span>
    <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="mf">1.68</span><span class="p">,</span> <span class="mf">4.7</span><span class="p">),</span>
    <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span>
    <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;log(Frequency) [Hz]&quot;</span><span class="p">,</span>
    <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;Decidecade SPSDL [dB re 1 uPa^2/Hz]&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
c:\users\mcve343\mhkit-python\mhkit\acoustics\analysis.py:83: UserWarning: `fmax` = 100000 is greater than the Nyquist frequency. Settingfmax = 48000.0
  warnings.warn(
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[[&lt;matplotlib.axis.XTick at 0x20703772990&gt;,
  &lt;matplotlib.axis.XTick at 0x207037a05d0&gt;,
  &lt;matplotlib.axis.XTick at 0x2070694f490&gt;,
  &lt;matplotlib.axis.XTick at 0x20704e02690&gt;,
  &lt;matplotlib.axis.XTick at 0x20704de5750&gt;,
  &lt;matplotlib.axis.XTick at 0x20704e1db90&gt;],
 [Text(0.0, 0, &#39;0&#39;),
  Text(1.0, 0, &#39;1&#39;),
  Text(2.0, 0, &#39;2&#39;),
  Text(3.0, 0, &#39;3&#39;),
  Text(4.0, 0, &#39;4&#39;),
  Text(5.0, 0, &#39;5&#39;)],
 (1.68, 4.7),
 (20.0, 100.0),
 Text(0.5, 0, &#39;log(Frequency) [Hz]&#39;),
 Text(0, 0.5, &#39;Decidecade SPSDL [dB re 1 uPa^2/Hz]&#39;)]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/acoustics_example_30_2.png" src="_images/acoustics_example_30_2.png" />
</div>
</div>
</section>
<section id="Sound-Pressure-Level">
<h2>Sound Pressure Level<a class="headerlink" href="#Sound-Pressure-Level" title="Link to this heading"></a></h2>
<p>The IEC-40 has two requirements considering calculations of sound pressure level (SPL). We’ll first calculate the SPL over the full frequency range of the turbine and/or hydrophone. The IEC-40 asks that the range be set from 10 to 100,000 Hz, though the lower limit can be increased due to flow noise or low frequency signal loss due to shallow water.</p>
<section id="Shallow-water-cutoff-frequency">
<h3>Shallow water cutoff frequency<a class="headerlink" href="#Shallow-water-cutoff-frequency" title="Link to this heading"></a></h3>
<p>Low frequency sound is absorbed into the seabed in shallow water depths. We can use the function <code class="docutils literal notranslate"><span class="pre">minimum_frequency</span></code> to get an approximation of what our minimum frequency should be. This approximation uses the water depth, estimates of the in-water sound speed and sea/riverbed sound speed to determine what the cutoff frequency will be. The difficult part with this approximation is figuring out the speed of sound in the bed material, which generally ranges from 1450-1800 m/s.</p>
<p>This function should only be used as a rough approximation and sanity check if significant attenuation is seen at various low frequencies and harmonics.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">depths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">80</span><span class="p">])</span>
<span class="n">fmin</span> <span class="o">=</span> <span class="n">acoustics</span><span class="o">.</span><span class="n">minimum_frequency</span><span class="p">(</span><span class="n">water_depth</span><span class="o">=</span><span class="n">depths</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="mi">1500</span><span class="p">,</span> <span class="n">c_seabed</span><span class="o">=</span><span class="mi">1700</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Depth [m], Freq [Hz]&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">d</span><span class="p">,</span> <span class="n">f</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">depths</span><span class="p">,</span> <span class="n">fmin</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">d</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">f</span><span class="si">:</span><span class="s2">0.1f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Depth [m], Freq [Hz]
1, 796.9
5, 159.4
10, 79.7
20, 39.8
40, 19.9
80, 10.0
</pre></div></div>
</div>
<p>Though the IEC-40 says we should default to a minimum frequency of 10 Hz, as you can see above, unless we’re measuring from a depth of around 80 +/- 10 m, our minimum frequency should be higher. One can play around with the bed soundspeed to see how these change with varying bed densities/compositions.</p>
</section>
<section id="Flow-Noise">
<h3>Flow Noise<a class="headerlink" href="#Flow-Noise" title="Link to this heading"></a></h3>
<p>Flow noise, or psuedo-sound, is the other reason to increase the minimum frequency of our SPL measurements. Flow noise is caused by one of three things: turbulence advected past the hydrophone element, turbulence caused by the hydrophone element, and the sensitivity of the hydrophone element to temperature inhomogeneities in the advected flow. Flow noise is most noticeably apparent when flow speeds increase above 0.5 m/s, seen in spectrograms as a logarithmic increase in pressure with decreasing
frequency.</p>
</section>
<section id="Cumulative-SPL">
<h3>Cumulative SPL<a class="headerlink" href="#Cumulative-SPL" title="Link to this heading"></a></h3>
<p>The particular data shown here was measured in around 8-10 m of water, and a mix of mild flow noise below 20 Hz and low frequency attenutation below ~50 Hz can be seen in the spectrogram. We’ll again use the Nyquist frequency of 48,000 Hz.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Sound pressure level</span>
<span class="n">fmin</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">fmax</span> <span class="o">=</span> <span class="mi">48000</span>

<span class="n">spl</span> <span class="o">=</span> <span class="n">acoustics</span><span class="o">.</span><span class="n">sound_pressure_level</span><span class="p">(</span><span class="n">spsd</span><span class="p">,</span> <span class="n">fmin</span><span class="p">,</span> <span class="n">fmax</span><span class="p">)</span>
<span class="n">spl</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&lt;matplotlib.lines.Line2D at 0x20706250fd0&gt;]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/acoustics_example_35_1.png" src="_images/acoustics_example_35_1.png" />
</div>
</div>
<p>So we can see our cumulative SPL start out at 86 dB and then peak at 120 dB as the boat drives by. If you haven’t listened to the audio track, this peak SPL of 125 dB rel 1 uPa (underwater) is equivalent to 99 dB rel 20 uPa (air). For reference, the OSHA time limit for workers experiencing 100 dB rel 20 uPa of sound is 2 hours. Vessel traffic quite loud and is the largest contributor to noise in the marine environment.</p>
</section>
</section>
<section id="Decidecade-Sound-Pressure-Levels">
<h2>Decidecade Sound Pressure Levels<a class="headerlink" href="#Decidecade-Sound-Pressure-Levels" title="Link to this heading"></a></h2>
<p>The last stat that IEC-40 requests are the decidecade SPLs. Note that the IEC-40 incorrectly labels these as synonymous with the third-octave SPLs, following the relevant (and also incorrect) ANSI specifications.</p>
<p>To explain, an octave is a frequency band where the upper frequency is double (2^1) that of the lower frequency. The one-third octave is a frequency band where the upper frequency is 2^(1/3) times the lower frequency. The decidecade is a frequency band with a bandwidth of 2^(1/10), which means it’s the tenth octave, not the third. Wherever the IEC-40 says third octave they actually mean the decidecade band.</p>
<p>We can calculate the SPL in each decidecade band using the function <code class="docutils literal notranslate"><span class="pre">decidecade_sound_pressure_level</span></code>. This function uses the same calculation as <code class="docutils literal notranslate"><span class="pre">sound_pressure_level</span></code> above and runs it on each tenth octave band. It returns 1 SPL in each frequency band every timestamp, so our boxplots show 5 minutes worth of SPL measurements in each decidecade band. You’ll notice a similar spread as in the SPSDL boxplots, especially in the upper quantile. Boats are loud.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Decidecade octave sound pressure level (also interquartile)</span>
<span class="n">spl10</span> <span class="o">=</span> <span class="n">acoustics</span><span class="o">.</span><span class="n">decidecade_sound_pressure_level</span><span class="p">(</span><span class="n">spsd</span><span class="p">,</span> <span class="n">fmin</span><span class="p">,</span> <span class="n">fmax</span><span class="p">)</span>

<span class="c1"># Plot the decidecade sound pressure level</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span>
    <span class="n">spl10</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
    <span class="n">whis</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">99</span><span class="p">),</span>
    <span class="n">showfliers</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">positions</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">spl10</span><span class="p">[</span><span class="s2">&quot;freq_bins&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">),</span>
    <span class="n">widths</span><span class="o">=</span><span class="mf">0.015</span><span class="p">,</span>
    <span class="n">flierprops</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;marker&quot;</span><span class="p">:</span> <span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="s2">&quot;markersize&quot;</span><span class="p">:</span> <span class="mf">1.5</span><span class="p">},</span>
<span class="p">)</span>
<span class="n">xticks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span>
    <span class="n">xticks</span><span class="o">=</span><span class="n">xticks</span><span class="p">,</span>
    <span class="n">xticklabels</span><span class="o">=</span><span class="n">xticks</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">),</span>
    <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="mf">1.68</span><span class="p">,</span> <span class="mf">4.75</span><span class="p">),</span>
    <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="mi">40</span><span class="p">,</span> <span class="mi">120</span><span class="p">),</span>
    <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;log(Frequency) [Hz]&quot;</span><span class="p">,</span>
    <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;Decidecade SPL [dB re 1 uPa]&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[[&lt;matplotlib.axis.XTick at 0x20709d51dd0&gt;,
  &lt;matplotlib.axis.XTick at 0x20709da66d0&gt;,
  &lt;matplotlib.axis.XTick at 0x2070aef2b90&gt;,
  &lt;matplotlib.axis.XTick at 0x2070af30b50&gt;,
  &lt;matplotlib.axis.XTick at 0x20704d97690&gt;,
  &lt;matplotlib.axis.XTick at 0x20709e04a10&gt;],
 [Text(0.0, 0, &#39;0&#39;),
  Text(1.0, 0, &#39;1&#39;),
  Text(2.0, 0, &#39;2&#39;),
  Text(3.0, 0, &#39;3&#39;),
  Text(4.0, 0, &#39;4&#39;),
  Text(5.0, 0, &#39;5&#39;)],
 (1.68, 4.75),
 (40.0, 120.0),
 Text(0.5, 0, &#39;log(Frequency) [Hz]&#39;),
 Text(0, 0.5, &#39;Decidecade SPL [dB re 1 uPa]&#39;)]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/acoustics_example_38_1.png" src="_images/acoustics_example_38_1.png" />
</div>
</div>
</section>
<section id="Third-Octave-Sound-Pressure-Level">
<h2>Third Octave Sound Pressure Level<a class="headerlink" href="#Third-Octave-Sound-Pressure-Level" title="Link to this heading"></a></h2>
<p>Since you’re now curious, you can also calculate the 1/3 octave SPLs using <code class="docutils literal notranslate"><span class="pre">third_octave_sound_pressure_level</span></code>. Third octaves are often measured because the human ear appears to have evolved to filter sound at this bandwidth, and these plots may also be used to reduce the “busy-ness” of a figure.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Median third octave sound pressure level</span>
<span class="n">spl3</span> <span class="o">=</span> <span class="n">acoustics</span><span class="o">.</span><span class="n">third_octave_sound_pressure_level</span><span class="p">(</span><span class="n">spsd</span><span class="p">,</span> <span class="n">fmin</span><span class="p">,</span> <span class="n">fmax</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span>
    <span class="n">spl3</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
    <span class="n">whis</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">99</span><span class="p">),</span>
    <span class="n">showfliers</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">positions</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">spl3</span><span class="p">[</span><span class="s2">&quot;freq_bins&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">),</span>
    <span class="n">widths</span><span class="o">=</span><span class="mf">0.04</span><span class="p">,</span>
    <span class="n">flierprops</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;marker&quot;</span><span class="p">:</span> <span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="s2">&quot;markersize&quot;</span><span class="p">:</span> <span class="mf">1.5</span><span class="p">},</span>
<span class="p">)</span>
<span class="n">xticks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span>
    <span class="n">xticks</span><span class="o">=</span><span class="n">xticks</span><span class="p">,</span>
    <span class="n">xticklabels</span><span class="o">=</span><span class="n">xticks</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">),</span>
    <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="mf">1.68</span><span class="p">,</span> <span class="mf">4.75</span><span class="p">),</span>
    <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">130</span><span class="p">),</span>
    <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;log(Frequency) [Hz]&quot;</span><span class="p">,</span>
    <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;Decidecade SPL [dB re 1 uPa]&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[[&lt;matplotlib.axis.XTick at 0x2070b2aa190&gt;,
  &lt;matplotlib.axis.XTick at 0x2070b04c650&gt;,
  &lt;matplotlib.axis.XTick at 0x2070bb42e10&gt;,
  &lt;matplotlib.axis.XTick at 0x20709a48150&gt;,
  &lt;matplotlib.axis.XTick at 0x2070bb4e350&gt;,
  &lt;matplotlib.axis.XTick at 0x2070b1743d0&gt;],
 [Text(0.0, 0, &#39;0&#39;),
  Text(1.0, 0, &#39;1&#39;),
  Text(2.0, 0, &#39;2&#39;),
  Text(3.0, 0, &#39;3&#39;),
  Text(4.0, 0, &#39;4&#39;),
  Text(5.0, 0, &#39;5&#39;)],
 (1.68, 4.75),
 (50.0, 130.0),
 Text(0.5, 0, &#39;log(Frequency) [Hz]&#39;),
 Text(0, 0.5, &#39;Decidecade SPL [dB re 1 uPa]&#39;)]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/acoustics_example_40_1.png" src="_images/acoustics_example_40_1.png" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="WPTO_hindcast_example.html" class="btn btn-neutral float-left" title="MHKiT WPTO Hindcast Example" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="adcp_example.html" class="btn btn-neutral float-right" title="Analyzing ADCP Data with MHKiT" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2019, National Renewable Energy Laboratory, Pacific Northwest National Laboratory, and Sandia National Laboratories.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>